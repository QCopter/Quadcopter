
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      --><title>filt</title><meta name="generator" content="MATLAB 7.10"><meta name="date" content="2013-06-12"><meta name="m-file" content="filt"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">function</span> [filtdata] = filt(rawdata,fsamp,fcut,hilo,plotswitch)
<span class="comment">%</span>
<span class="comment">% function filt(rawdata,fsamp,fcut,hilo,plotswitch)</span>
<span class="comment">%</span>
<span class="comment">% - performs low or high-pass filtering based on a Chebychev filter type</span>
<span class="comment">% - returns the filtered data</span>
<span class="comment">%</span>
<span class="comment">% input:   rawdata - input raw data vector</span>
<span class="comment">%            fsamp - sampling rate of raw data</span>
<span class="comment">%             fcut - filter cut-off frequency</span>
<span class="comment">%             hilo - filter type (0:low-pass, 1:high-pass) - defaults to low-pass</span>
<span class="comment">%       plotswitch - plot data? (0:no, 1:yes) - defaults to yes</span>
<span class="comment">%</span>
<span class="comment">% output: filtdata - filtered data set</span>
<span class="comment">%         plot of raw and filtered data</span>

<span class="keyword">if</span> nargin == 0, fprintf(<span class="string">'\n  Error: specify input vector, sampling frequency and cutoff frequency\n\n'</span>); <span class="keyword">end</span>
<span class="keyword">if</span> nargin == 1, fprintf(<span class="string">'\n  Error: specify sampling frequency and cutoff frequency\n\n'</span>); <span class="keyword">end</span>
<span class="keyword">if</span> nargin == 2, fprintf(<span class="string">'\n  Error: specify cutoff frequency\n\n'</span>); <span class="keyword">end</span>
<span class="keyword">if</span> nargin == 3, hilo=0; plotswitch=1; <span class="keyword">end</span>
<span class="keyword">if</span> nargin == 4,         plotswitch=1; <span class="keyword">end</span>

<span class="keyword">if</span> hilo == 1
	highswitch = <span class="string">'high'</span>;
<span class="keyword">else</span> highswitch = <span class="string">'low'</span>;
<span class="keyword">end</span>

[b,a] = cheby2(12,40,fcut/(fsamp/2),highswitch);
filtdata = filtfilt(b,a,rawdata);
<span class="keyword">if</span> plotswitch == 1
  dt = 1/fsamp;
  tvect = (0:dt:dt*(length(rawdata)-1));
  plot(tvect,rawdata,<span class="string">'b'</span>,tvect,filtdata,<span class="string">'r'</span>)
  legend(<span class="string">'raw'</span>,<span class="string">'filtered'</span>)
<span class="keyword">end</span>
</pre><pre class="codeoutput">
  Error: specify input vector, sampling frequency and cutoff frequency

</pre><pre class="codeoutput">Input argument "hilo" is undefined.

Error in ==&gt; filt at 23
if hilo == 1 
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.10<br></p></div><!--
##### SOURCE BEGIN #####
function [filtdata] = filt(rawdata,fsamp,fcut,hilo,plotswitch)
%
% function filt(rawdata,fsamp,fcut,hilo,plotswitch)
%
% - performs low or high-pass filtering based on a Chebychev filter type 
% - returns the filtered data
%
% input:   rawdata - input raw data vector
%            fsamp - sampling rate of raw data
%             fcut - filter cut-off frequency
%             hilo - filter type (0:low-pass, 1:high-pass) - defaults to low-pass
%       plotswitch - plot data? (0:no, 1:yes) - defaults to yes
%
% output: filtdata - filtered data set
%         plot of raw and filtered data

if nargin == 0, fprintf('\n  Error: specify input vector, sampling frequency and cutoff frequency\n\n'); end
if nargin == 1, fprintf('\n  Error: specify sampling frequency and cutoff frequency\n\n'); end
if nargin == 2, fprintf('\n  Error: specify cutoff frequency\n\n'); end
if nargin == 3, hilo=0; plotswitch=1; end
if nargin == 4,         plotswitch=1; end

if hilo == 1 
	highswitch = 'high'; 
else highswitch = 'low'; 
end 

[b,a] = cheby2(12,40,fcut/(fsamp/2),highswitch);
filtdata = filtfilt(b,a,rawdata);
if plotswitch == 1
  dt = 1/fsamp;
  tvect = (0:dt:dt*(length(rawdata)-1));
  plot(tvect,rawdata,'b',tvect,filtdata,'r')
  legend('raw','filtered')
end
##### SOURCE END #####
--></body></html>